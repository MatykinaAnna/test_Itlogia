{"ast":null,"code":"import { HttpService } from './http.service';\nimport { HttpServiceParam } from './http.serviceParam';\nimport { Filtr_numTransfer } from './classes/filtr_numTransfer';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"./app.ticket\";\nconst _c0 = [\"b1\"];\nconst _c1 = [\"b2\"];\nconst _c2 = [\"b3\"];\n\nfunction AppComponentTicket_my_ticket_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"my-ticket\", 26);\n  }\n\n  if (rf & 2) {\n    const ticket_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ticket\", ticket_r4);\n  }\n}\n\nexport let AppComponentTicket = /*#__PURE__*/(() => {\n  class AppComponentTicket {\n    constructor(http, renderer) {\n      this.http = http;\n      this.renderer = renderer;\n      this.b1 = undefined;\n      this.b2 = undefined;\n      this.b3 = undefined;\n      this.tickets = [];\n      this.ticketsWithoutFilter = [];\n      this.filtr_numTransfer = new Filtr_numTransfer(true, false, false, false, false);\n      this.numTicketsOnScreen = 5;\n      this.httpServiceGetSearchId = new HttpService(http);\n      this.httpServiceGetTickets = new HttpServiceParam(http);\n    }\n\n    ngOnInit() {\n      // this.filtr_numTransfer = new Filtr_numTransfer(true, false, false, false, false)\n      this.httpServiceGetSearchId.getData('https://front-test.beta.aviasales.ru/search').subscribe(data => {\n        let searchId = data.searchId;\n        this.getPackOfTickets(searchId);\n      });\n    }\n\n    ngDoCheck() {}\n\n    ngAfterViewInit() {}\n\n    applyFilter() {}\n\n    getPackOfTickets(searchId) {\n      this.httpServiceGetTickets.getData(searchId).subscribe(data => {\n        data.tickets.forEach(element => {\n          this.tickets.push(element);\n        });\n        this.ticketsWithoutFilter = this.tickets;\n      });\n    }\n\n    sortForPrice() {\n      if (this.b1 && this.b2 && this.b3) {\n        this.renderer.addClass(this.b1.nativeElement, 'active');\n        this.renderer.removeClass(this.b2.nativeElement, 'active');\n        this.renderer.removeClass(this.b3.nativeElement, 'active');\n        this.tickets.sort(function (a, b) {\n          return a.price - b.price;\n        });\n      }\n    }\n\n    sortForDuration() {\n      if (this.b1 && this.b2 && this.b3) {\n        this.renderer.addClass(this.b2.nativeElement, 'active');\n        this.renderer.removeClass(this.b1.nativeElement, 'active');\n        this.renderer.removeClass(this.b3.nativeElement, 'active');\n        this.tickets.sort(function (a, b) {\n          return a.segments[0].duration + a.segments[1].duration - (b.segments[0].duration + b.segments[1].duration);\n        });\n      }\n    }\n\n    optimal() {\n      if (this.b1 && this.b2 && this.b3) {\n        this.renderer.addClass(this.b3.nativeElement, 'active');\n        this.renderer.removeClass(this.b2.nativeElement, 'active');\n        this.renderer.removeClass(this.b1.nativeElement, 'active');\n        console.log('оптимальный');\n      }\n    }\n\n    filterBy() {\n      let rezult = [];\n\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.all) {\n          this.filterByNumberOfStops(0).forEach(item => {\n            rezult.push(item);\n          });\n          return rezult;\n        }\n\n        if (this.filtr_numTransfer.one) {\n          this.filterByNumberOfStops(1).forEach(item => {\n            rezult.push(item);\n          });\n        }\n\n        if (this.filtr_numTransfer.two) {\n          this.filterByNumberOfStops(2).forEach(item => {\n            rezult.push(item);\n          });\n        }\n\n        if (this.filtr_numTransfer.three) {\n          this.filterByNumberOfStops(3).forEach(item => {\n            rezult.push(item);\n          });\n        }\n\n        if (this.filtr_numTransfer.without) {\n          this.filterByNumberOfStops(0).forEach(item => {\n            rezult.push(item);\n          });\n        }\n      }\n\n      return rezult;\n    }\n\n    setFilterAll() {\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.all) {\n          this.filtr_numTransfer.one = false;\n          this.filtr_numTransfer.two = false;\n          this.filtr_numTransfer.three = false;\n          this.filtr_numTransfer.without = false;\n        }\n\n        this.tickets = this.filterBy();\n      }\n    }\n\n    setFilterOne() {\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.one) {\n          this.filtr_numTransfer.all = false;\n        }\n\n        this.tickets = this.filterBy();\n      }\n    }\n\n    setFilterTwo() {\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.two) {\n          this.filtr_numTransfer.all = false;\n        }\n\n        this.tickets = this.filterBy();\n      }\n    }\n\n    setFilterThree() {\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.three) {\n          this.filtr_numTransfer.all = false;\n        }\n\n        this.tickets = this.filterBy();\n      }\n    }\n\n    setFilterWithout() {\n      if (this.filtr_numTransfer) {\n        if (this.filtr_numTransfer.without) {\n          this.filtr_numTransfer.all = false;\n        }\n\n        this.tickets = this.filterBy();\n      }\n    }\n\n    filterByNumberOfStops(num) {\n      if (num == -1) {\n        return this.ticketsWithoutFilter;\n      }\n\n      let rezult = [];\n      this.ticketsWithoutFilter.forEach(element => {\n        if (element.segments[0].stops.length + element.segments[1].stops.length == num) {\n          rezult.push(element);\n        }\n      });\n      return rezult;\n    }\n\n    addNumTicketsOnScreen() {\n      this.numTicketsOnScreen += 5;\n    }\n\n  }\n\n  AppComponentTicket.ɵfac = function AppComponentTicket_Factory(t) {\n    return new (t || AppComponentTicket)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i0.Renderer2));\n  };\n\n  AppComponentTicket.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponentTicket,\n    selectors: [[\"my-app\"]],\n    viewQuery: function AppComponentTicket_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n        i0.ɵɵviewQuery(_c2, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.b1 = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.b2 = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.b3 = _t.first);\n      }\n    },\n    features: [i0.ɵɵProvidersFeature([HttpService])],\n    decls: 42,\n    vars: 10,\n    consts: [[1, \"container\"], [1, \"logo\"], [\"src\", \"../assets/img/Logo.svg\", \"alt\", \"\"], [1, \"content\"], [1, \"tickets\"], [1, \"filtr\"], [1, \"filtr_header\"], [1, \"check\"], [\"type\", \"checkbox\", \"id\", \"all\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"for\", \"all\"], [\"type\", \"checkbox\", \"id\", \"without\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"for\", \"without\"], [\"type\", \"checkbox\", \"id\", \"one\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"for\", \"one\"], [\"type\", \"checkbox\", \"id\", \"two\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"for\", \"two\"], [\"type\", \"checkbox\", \"id\", \"three\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"for\", \"three\"], [1, \"btn\", \"b1\", 3, \"click\"], [\"b1\", \"\"], [1, \"btn\", \"b2\", 3, \"click\"], [\"b2\", \"\"], [1, \"btn\", \"b3\", \"active\", 3, \"click\"], [\"b3\", \"\"], [3, \"ticket\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"show\", 3, \"click\"], [3, \"ticket\"]],\n    template: function AppComponentTicket_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"img\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"div\", 6);\n        i0.ɵɵtext(7, \" \\u041A\\u041E\\u041B\\u0418\\u0427\\u0415\\u0421\\u0422\\u0412\\u041E \\u041F\\u0415\\u0420\\u0415\\u0421\\u0410\\u0414\\u041E\\u041A \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7)(9, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponentTicket_Template_input_ngModelChange_9_listener($event) {\n          return ctx.filtr_numTransfer.all = $event;\n        })(\"change\", function AppComponentTicket_Template_input_change_9_listener() {\n          return ctx.setFilterAll();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"label\", 9);\n        i0.ɵɵtext(11, \"\\u0412\\u0441\\u0435\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 7)(13, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponentTicket_Template_input_ngModelChange_13_listener($event) {\n          return ctx.filtr_numTransfer.without = $event;\n        })(\"change\", function AppComponentTicket_Template_input_change_13_listener() {\n          return ctx.setFilterWithout();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"label\", 11);\n        i0.ɵɵtext(15, \"\\u0411\\u0435\\u0437 \\u043F\\u0435\\u0440\\u0435\\u0441\\u0430\\u0434\\u043E\\u043A\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(16, \"div\", 7)(17, \"input\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponentTicket_Template_input_ngModelChange_17_listener($event) {\n          return ctx.filtr_numTransfer.one = $event;\n        })(\"change\", function AppComponentTicket_Template_input_change_17_listener() {\n          return ctx.setFilterOne();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"label\", 13);\n        i0.ɵɵtext(19, \"1 \\u043F\\u0435\\u0440\\u0435\\u0441\\u0430\\u0434\\u043A\\u0430\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(20, \"div\", 7)(21, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponentTicket_Template_input_ngModelChange_21_listener($event) {\n          return ctx.filtr_numTransfer.two = $event;\n        })(\"change\", function AppComponentTicket_Template_input_change_21_listener() {\n          return ctx.setFilterTwo();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"label\", 15);\n        i0.ɵɵtext(23, \"2 \\u043F\\u0435\\u0440\\u0435\\u0441\\u0430\\u0434\\u043A\\u0438\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"div\", 7)(25, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponentTicket_Template_input_ngModelChange_25_listener($event) {\n          return ctx.filtr_numTransfer.three = $event;\n        })(\"change\", function AppComponentTicket_Template_input_change_25_listener() {\n          return ctx.setFilterThree();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"label\", 17);\n        i0.ɵɵtext(27, \"3 \\u043F\\u0435\\u0440\\u0435\\u0441\\u0430\\u0434\\u043A\\u0438\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"div\")(29, \"button\", 18, 19);\n        i0.ɵɵlistener(\"click\", function AppComponentTicket_Template_button_click_29_listener() {\n          return ctx.sortForPrice();\n        });\n        i0.ɵɵtext(31, \"\\u0421\\u0410\\u041C\\u042B\\u0419 \\u0414\\u0415\\u0428\\u0415\\u0412\\u042B\\u0419\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"button\", 20, 21);\n        i0.ɵɵlistener(\"click\", function AppComponentTicket_Template_button_click_32_listener() {\n          return ctx.sortForDuration();\n        });\n        i0.ɵɵtext(34, \"\\u0421\\u0410\\u041C\\u042B\\u0419 \\u0411\\u042B\\u0421\\u0422\\u0420\\u042B\\u0419\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"button\", 22, 23);\n        i0.ɵɵlistener(\"click\", function AppComponentTicket_Template_button_click_35_listener() {\n          return ctx.optimal();\n        });\n        i0.ɵɵtext(37, \"\\u041E\\u041F\\u0422\\u0418\\u041C\\u0410\\u041B\\u042C\\u041D\\u042B\\u0419\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(38, AppComponentTicket_my_ticket_38_Template, 1, 1, \"my-ticket\", 24);\n        i0.ɵɵpipe(39, \"slice\");\n        i0.ɵɵelementStart(40, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function AppComponentTicket_Template_button_click_40_listener() {\n          return ctx.addNumTicketsOnScreen();\n        });\n        i0.ɵɵtext(41, \"\\u041F\\u041E\\u041A\\u0410\\u0417\\u0410\\u0422\\u042C \\u0415\\u0429\\u0415 5 \\u0411\\u0418\\u041B\\u0415\\u0422\\u041E\\u0412!\");\n        i0.ɵɵelementEnd()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtr_numTransfer.all);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtr_numTransfer.without);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtr_numTransfer.one);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtr_numTransfer.two);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.filtr_numTransfer.three);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind3(39, 6, ctx.tickets, 0, ctx.numTicketsOnScreen));\n      }\n    },\n    directives: [i2.CheckboxControlValueAccessor, i2.NgControlStatus, i2.NgModel, i3.NgForOf, i4.AppTicket],\n    pipes: [i3.SlicePipe],\n    styles: [\"input[type=checkbox i][_ngcontent-%COMP%]{height:20px;width:20px;background-color:initial;cursor:default;-webkit-appearance:auto;appearance:auto;box-sizing:border-box;margin:0 10px 0 0;padding:initial;border:initial;border:solid #9ABBCE}.container[_ngcontent-%COMP%]{background-color:#f3f7fa;padding:50px 103px}.logo[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:50px}.content[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center}.tickets[_ngcontent-%COMP%]{display:flex}.filtr[_ngcontent-%COMP%]{height:252px;width:232px;background-color:#fff;padding:20px 20px 0;border-radius:5px;color:#4a4a4a;margin-right:20px}.filtr_header[_ngcontent-%COMP%]{font-family:Open Sans;font-size:16px;margin-bottom:20px}.check[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:20px}label[_ngcontent-%COMP%]{font-family:Open Sans;font-size:16px}button[_ngcontent-%COMP%]{padding:20px 0;border:none;font:inherit;color:inherit;background-color:transparent;cursor:pointer}.btn[_ngcontent-%COMP%]{font-size:12px;width:168px;height:50px;padding:19px 25px 20px;font-family:Open Sans;border:solid .5px #DFE5EC;margin-bottom:20px}.b1[_ngcontent-%COMP%]{border-top-left-radius:5px;border-bottom-left-radius:5px}.b3[_ngcontent-%COMP%]{border-top-right-radius:5px;border-bottom-right-radius:5px}.active[_ngcontent-%COMP%]{background-color:#2196f3;border-color:#2196f3;color:#fff}.show[_ngcontent-%COMP%]{width:100%;background-color:#2196f3;border-color:#2196f3;color:#fff;border-radius:5px}\"]\n  });\n  return AppComponentTicket;\n})();","map":null,"metadata":{},"sourceType":"module"}